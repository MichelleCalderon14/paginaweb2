{"ast":null,"code":"import { CommonModule } from '@angular/common';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../shared/auth.service\";\nimport * as i2 from \"@angular/common\";\nfunction AlumnoNotasPage_ng_container_3_p_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ÉµÉµelementStart(0, \"p\", 8);\n    i0.ÉµÉµtext(1, \" Alumno: \");\n    i0.ÉµÉµelementStart(2, \"strong\");\n    i0.ÉµÉµtext(3);\n    i0.ÉµÉµelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ÉµÉµnextContext(2);\n    i0.ÉµÉµadvance(3);\n    i0.ÉµÉµtextInterpolate(ctx_r0.alumnoNombre);\n  }\n}\nfunction AlumnoNotasPage_ng_container_3_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ÉµÉµelementStart(0, \"div\", 9);\n    i0.ÉµÉµtext(1, \" A\\u00FAn no hay calificaciones registradas para ti en este equipo. \");\n    i0.ÉµÉµelementEnd();\n  }\n}\nfunction AlumnoNotasPage_ng_container_3_div_3_tr_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ÉµÉµelementStart(0, \"tr\")(1, \"td\", 12);\n    i0.ÉµÉµtext(2);\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµelementStart(3, \"td\");\n    i0.ÉµÉµtext(4);\n    i0.ÉµÉµelementEnd()();\n  }\n  if (rf & 2) {\n    const n_r2 = ctx.$implicit;\n    i0.ÉµÉµadvance(2);\n    i0.ÉµÉµtextInterpolate(n_r2.tarea);\n    i0.ÉµÉµadvance(2);\n    i0.ÉµÉµtextInterpolate(n_r2.valor === null ? \"\\u2014\" : n_r2.valor);\n  }\n}\nfunction AlumnoNotasPage_ng_container_3_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ÉµÉµelementStart(0, \"div\")(1, \"table\", 10)(2, \"thead\", 11)(3, \"tr\")(4, \"th\", 12);\n    i0.ÉµÉµtext(5, \"Tarea\");\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµelementStart(6, \"th\");\n    i0.ÉµÉµtext(7, \"Nota\");\n    i0.ÉµÉµelementEnd()()();\n    i0.ÉµÉµelementStart(8, \"tbody\");\n    i0.ÉµÉµtemplate(9, AlumnoNotasPage_ng_container_3_div_3_tr_9_Template, 5, 2, \"tr\", 13);\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµelementStart(10, \"tfoot\")(11, \"tr\")(12, \"th\", 14);\n    i0.ÉµÉµtext(13, \"Promedio\");\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµelementStart(14, \"th\");\n    i0.ÉµÉµtext(15);\n    i0.ÉµÉµelementEnd()();\n    i0.ÉµÉµelementStart(16, \"tr\")(17, \"th\", 14);\n    i0.ÉµÉµtext(18, \"Estado\");\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµelementStart(19, \"th\", 15);\n    i0.ÉµÉµtext(20);\n    i0.ÉµÉµelementEnd()()()()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ÉµÉµnextContext(2);\n    i0.ÉµÉµadvance(9);\n    i0.ÉµÉµproperty(\"ngForOf\", ctx_r0.notas);\n    i0.ÉµÉµadvance(6);\n    i0.ÉµÉµtextInterpolate(ctx_r0.promedio === null ? \"\\u2014\" : ctx_r0.promedio);\n    i0.ÉµÉµadvance(4);\n    i0.ÉµÉµproperty(\"ngClass\", ctx_r0.estado === \"Aprueba\" ? \"text-success\" : ctx_r0.estado === \"Reprueba\" ? \"text-danger\" : \"\");\n    i0.ÉµÉµadvance();\n    i0.ÉµÉµtextInterpolate1(\" \", ctx_r0.estado || \"\\u2014\", \" \");\n  }\n}\nfunction AlumnoNotasPage_ng_container_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ÉµÉµelementContainerStart(0);\n    i0.ÉµÉµtemplate(1, AlumnoNotasPage_ng_container_3_p_1_Template, 4, 1, \"p\", 4)(2, AlumnoNotasPage_ng_container_3_div_2_Template, 2, 0, \"div\", 5)(3, AlumnoNotasPage_ng_container_3_div_3_Template, 21, 4, \"div\", 6);\n    i0.ÉµÉµelementStart(4, \"p\", 7);\n    i0.ÉµÉµtext(5, \" * Estos datos se leen del registro guardado por el docente en este mismo equipo. \");\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ÉµÉµnextContext();\n    i0.ÉµÉµadvance();\n    i0.ÉµÉµproperty(\"ngIf\", ctx_r0.alumnoNombre);\n    i0.ÉµÉµadvance();\n    i0.ÉµÉµproperty(\"ngIf\", !ctx_r0.notas.length);\n    i0.ÉµÉµadvance();\n    i0.ÉµÉµproperty(\"ngIf\", ctx_r0.notas.length);\n  }\n}\nfunction AlumnoNotasPage_ng_template_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ÉµÉµelementStart(0, \"div\", 16);\n    i0.ÉµÉµtext(1, \" No se pudieron leer tus calificaciones. Verifica que el docente haya registrado tus notas y haya pulsado \\\"Guardar cambios\\\" en este equipo. \");\n    i0.ÉµÉµelementEnd();\n  }\n}\nexport let AlumnoNotasPage = /*#__PURE__*/(() => {\n  var _staticBlock;\n  class AlumnoNotasPage {\n    constructor(auth) {\n      this.auth = auth;\n      this.notas = [];\n      this.promedio = null;\n      this.estado = '';\n      this.alumnoNombre = '';\n      this.error = false;\n      // ðŸ‘‡ Mapeo usuario â†’ idAlumno + idDocente\n      this.MAP = {\n        // ajusta el idAlumno si en tu BD Cabrera Pepe tiene otro ID\n        'pepecabrera': {\n          idAlumno: 1,\n          nombre: 'Cabrera Pepe',\n          idDocente: 1\n        }\n      };\n    }\n    ngOnInit() {\n      const u = this.auth.currentUser;\n      const username = (u?.username || '').toLowerCase().replace(/\\s+/g, '');\n      const conf = this.MAP[username];\n      if (!conf) {\n        console.warn('AlumnoNotasPage: usuario sin mapeo', username);\n        this.error = true;\n        return;\n      }\n      this.alumnoNombre = conf.nombre;\n      const storageKey = `calif.docente.${conf.idDocente}`;\n      const raw = localStorage.getItem(storageKey);\n      if (!raw) {\n        this.error = true;\n        return;\n      }\n      let data;\n      try {\n        data = JSON.parse(raw);\n      } catch {\n        this.error = true;\n        return;\n      }\n      const tareas = data.tareas || [];\n      const notasAlumno = data.notasPorAlumno?.[conf.idAlumno] || [];\n      this.notas = tareas.map((t, idx) => ({\n        tarea: t,\n        valor: idx < notasAlumno.length ? notasAlumno[idx] : null\n      }));\n      this.calcularPromedioYEstado();\n    }\n    calcularPromedioYEstado() {\n      const valores = this.notas.map(n => n.valor).filter(v => v !== null && v !== undefined);\n      if (!valores.length) {\n        this.promedio = null;\n        this.estado = '';\n        return;\n      }\n      const suma = valores.reduce((acc, v) => acc + v, 0);\n      const prom = suma / valores.length;\n      this.promedio = Number(prom.toFixed(2));\n      this.estado = prom >= 7 ? 'Aprueba' : 'Reprueba';\n    }\n    static #_ = _staticBlock = () => (this.Éµfac = function AlumnoNotasPage_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || AlumnoNotasPage)(i0.ÉµÉµdirectiveInject(i1.AuthService));\n    }, this.Éµcmp = /*@__PURE__*/i0.ÉµÉµdefineComponent({\n      type: AlumnoNotasPage,\n      selectors: [[\"app-alumno-notas\"]],\n      decls: 6,\n      vars: 2,\n      consts: [[\"errorTpl\", \"\"], [1, \"p-4\", \"border\", \"rounded-3\", \"shadow-sm\"], [1, \"h4\", \"mb-3\"], [4, \"ngIf\", \"ngIfElse\"], [\"class\", \"mb-3\", 4, \"ngIf\"], [\"class\", \"alert alert-info\", 4, \"ngIf\"], [4, \"ngIf\"], [1, \"text-muted\", \"small\", \"mb-0\"], [1, \"mb-3\"], [1, \"alert\", \"alert-info\"], [1, \"table\", \"table-sm\", \"table-striped\", \"text-center\", \"align-middle\"], [1, \"table-primary\"], [1, \"text-start\"], [4, \"ngFor\", \"ngForOf\"], [1, \"text-end\"], [3, \"ngClass\"], [1, \"alert\", \"alert-danger\"]],\n      template: function AlumnoNotasPage_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ÉµÉµelementStart(0, \"div\", 1)(1, \"h2\", 2);\n          i0.ÉµÉµtext(2, \"Mis calificaciones\");\n          i0.ÉµÉµelementEnd();\n          i0.ÉµÉµtemplate(3, AlumnoNotasPage_ng_container_3_Template, 6, 3, \"ng-container\", 3)(4, AlumnoNotasPage_ng_template_4_Template, 2, 0, \"ng-template\", null, 0, i0.ÉµÉµtemplateRefExtractor);\n          i0.ÉµÉµelementEnd();\n        }\n        if (rf & 2) {\n          const errorTpl_r3 = i0.ÉµÉµreference(5);\n          i0.ÉµÉµadvance(3);\n          i0.ÉµÉµproperty(\"ngIf\", !ctx.error)(\"ngIfElse\", errorTpl_r3);\n        }\n      },\n      dependencies: [CommonModule, i2.NgClass, i2.NgForOf, i2.NgIf],\n      encapsulation: 2\n    }));\n  }\n  _staticBlock();\n  return AlumnoNotasPage;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}