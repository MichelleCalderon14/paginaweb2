{"ast":null,"code":"import { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { environment } from '../../../environments/environment';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"@angular/forms\";\nfunction DocenteCalificacionesPage_th_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const col_r1 = ctx.$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(col_r1);\n  }\n}\nfunction DocenteCalificacionesPage_tr_16_td_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r2 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"td\")(1, \"input\", 8);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function DocenteCalificacionesPage_tr_16_td_3_Template_input_ngModelChange_1_listener($event) {\n      const col_r3 = i0.ɵɵrestoreView(_r2).$implicit;\n      const a_r4 = i0.ɵɵnextContext().$implicit;\n      i0.ɵɵtwoWayBindingSet(a_r4.notas[col_r3], $event) || (a_r4.notas[col_r3] = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵlistener(\"ngModelChange\", function DocenteCalificacionesPage_tr_16_td_3_Template_input_ngModelChange_1_listener() {\n      i0.ɵɵrestoreView(_r2);\n      const a_r4 = i0.ɵɵnextContext().$implicit;\n      const ctx_r4 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r4.calcular(a_r4));\n    });\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const col_r3 = ctx.$implicit;\n    const a_r4 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtwoWayProperty(\"ngModel\", a_r4.notas[col_r3]);\n  }\n}\nfunction DocenteCalificacionesPage_tr_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(3, DocenteCalificacionesPage_tr_16_td_3_Template, 2, 1, \"td\", 5);\n    i0.ɵɵelementStart(4, \"td\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"td\", 7);\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const a_r4 = ctx.$implicit;\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate2(\"\", a_r4.apellidos, \" \", a_r4.nombres);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngForOf\", ctx_r4.columnas);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(a_r4.promedio);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngClass\", a_r4.estado === \"Aprueba\" ? \"text-success fw-bold\" : \"text-danger fw-bold\");\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", a_r4.estado, \" \");\n  }\n}\nexport let DocenteCalificacionesPage = /*#__PURE__*/(() => {\n  var _staticBlock;\n  class DocenteCalificacionesPage {\n    constructor(http) {\n      this.http = http;\n      // columnas por defecto\n      this.columnas = ['Tarea 1', 'Tarea 2'];\n      this.alumnos = [];\n      this.apiPanel = `${environment.apiBase}/panel`;\n      this.cargarDatos();\n    }\n    cargarDatos() {\n      const idDocente = Number(localStorage.getItem('idDocente'));\n      this.http.get(`${this.apiPanel}/docente/${idDocente}`).subscribe(data => {\n        this.alumnos = data.map(a => ({\n          ...a,\n          notas: {\n            'Tarea 1': a.tarea1 ?? null,\n            'Tarea 2': a.tarea2 ?? null\n          }\n        }));\n      });\n    }\n    agregarColumna() {\n      const nombre = prompt('Nombre de la nueva evaluación:');\n      if (!nombre) return;\n      if (!this.columnas.includes(nombre)) {\n        this.columnas.push(nombre);\n        this.alumnos.forEach(a => a.notas[nombre] = null);\n      }\n    }\n    calcular(a) {\n      const valores = Object.values(a.notas).filter(n => n !== null && n !== undefined && n !== '');\n      if (valores.length === 0) {\n        a.promedio = null;\n        a.estado = '';\n        return;\n      }\n      const suma = valores.reduce((acc, n) => acc + Number(n), 0);\n      const prom = suma / valores.length; // número\n      a.promedio = Number(prom.toFixed(2)); // se muestra con 2 decimales\n      a.estado = prom >= 7 ? 'Aprueba' : 'Reprueba';\n    }\n    guardar() {\n      this.http.post(`${this.apiPanel}/docente/${localStorage.getItem('idDocente')}`, this.alumnos).subscribe(() => {\n        alert('Calificaciones guardadas correctamente ✔');\n      });\n    }\n    static #_ = _staticBlock = () => (this.ɵfac = function DocenteCalificacionesPage_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || DocenteCalificacionesPage)(i0.ɵɵdirectiveInject(i1.HttpClient));\n    }, this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: DocenteCalificacionesPage,\n      selectors: [[\"app-docente-calificaciones\"]],\n      decls: 19,\n      vars: 2,\n      consts: [[1, \"container\", \"mt-4\"], [1, \"mb-3\"], [1, \"btn\", \"btn-primary\", \"mb-3\", 3, \"click\"], [1, \"table\", \"table-bordered\", \"table-striped\", \"text-center\"], [1, \"table-primary\"], [4, \"ngFor\", \"ngForOf\"], [1, \"btn\", \"btn-success\", 3, \"click\"], [3, \"ngClass\"], [\"type\", \"number\", \"min\", \"0\", \"max\", \"10\", \"step\", \"0.1\", 1, \"form-control\", 3, \"ngModelChange\", \"ngModel\"]],\n      template: function DocenteCalificacionesPage_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 0)(1, \"h2\", 1);\n          i0.ɵɵtext(2, \"Registro de Calificaciones\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(3, \"button\", 2);\n          i0.ɵɵlistener(\"click\", function DocenteCalificacionesPage_Template_button_click_3_listener() {\n            return ctx.agregarColumna();\n          });\n          i0.ɵɵtext(4, \" + Crear Evaluaci\\u00F3n \");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(5, \"table\", 3)(6, \"thead\", 4)(7, \"tr\")(8, \"th\");\n          i0.ɵɵtext(9, \"Estudiante\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(10, DocenteCalificacionesPage_th_10_Template, 2, 1, \"th\", 5);\n          i0.ɵɵelementStart(11, \"th\");\n          i0.ɵɵtext(12, \"Promedio\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(13, \"th\");\n          i0.ɵɵtext(14, \"Estado\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(15, \"tbody\");\n          i0.ɵɵtemplate(16, DocenteCalificacionesPage_tr_16_Template, 8, 6, \"tr\", 5);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(17, \"button\", 6);\n          i0.ɵɵlistener(\"click\", function DocenteCalificacionesPage_Template_button_click_17_listener() {\n            return ctx.guardar();\n          });\n          i0.ɵɵtext(18, \"Guardar Cambios\");\n          i0.ɵɵelementEnd()();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(10);\n          i0.ɵɵproperty(\"ngForOf\", ctx.columnas);\n          i0.ɵɵadvance(6);\n          i0.ɵɵproperty(\"ngForOf\", ctx.alumnos);\n        }\n      },\n      dependencies: [CommonModule, i2.NgClass, i2.NgForOf, FormsModule, i3.DefaultValueAccessor, i3.NumberValueAccessor, i3.NgControlStatus, i3.MinValidator, i3.MaxValidator, i3.NgModel],\n      encapsulation: 2\n    }));\n  }\n  _staticBlock();\n  return DocenteCalificacionesPage;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}