{"ast":null,"code":"import { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../alumnos/alumnos.service\";\nimport * as i2 from \"../../shared/auth.service\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/forms\";\nfunction DocenteCalificacionesPage_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ÉµÉµelementStart(0, \"div\", 6);\n    i0.ÉµÉµtext(1, \"Cargando alumnos\\u2026\");\n    i0.ÉµÉµelementEnd();\n  }\n}\nfunction DocenteCalificacionesPage_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ÉµÉµelementStart(0, \"div\", 7);\n    i0.ÉµÉµtext(1, \"No se pudieron cargar los alumnos.\");\n    i0.ÉµÉµelementEnd();\n  }\n}\nfunction DocenteCalificacionesPage_ng_container_5_table_3_th_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ÉµÉµelementStart(0, \"th\");\n    i0.ÉµÉµtext(1);\n    i0.ÉµÉµelementEnd();\n  }\n  if (rf & 2) {\n    const col_r3 = ctx.$implicit;\n    i0.ÉµÉµadvance();\n    i0.ÉµÉµtextInterpolate(col_r3);\n  }\n}\nfunction DocenteCalificacionesPage_ng_container_5_table_3_tr_11_td_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ÉµÉµgetCurrentView();\n    i0.ÉµÉµelementStart(0, \"td\")(1, \"input\", 15);\n    i0.ÉµÉµtwoWayListener(\"ngModelChange\", function DocenteCalificacionesPage_ng_container_5_table_3_tr_11_td_3_Template_input_ngModelChange_1_listener($event) {\n      const col_r5 = i0.ÉµÉµrestoreView(_r4).$implicit;\n      const a_r6 = i0.ÉµÉµnextContext().$implicit;\n      i0.ÉµÉµtwoWayBindingSet(a_r6.notas[col_r5], $event) || (a_r6.notas[col_r5] = $event);\n      return i0.ÉµÉµresetView($event);\n    });\n    i0.ÉµÉµlistener(\"ngModelChange\", function DocenteCalificacionesPage_ng_container_5_table_3_tr_11_td_3_Template_input_ngModelChange_1_listener() {\n      i0.ÉµÉµrestoreView(_r4);\n      const a_r6 = i0.ÉµÉµnextContext().$implicit;\n      const ctx_r1 = i0.ÉµÉµnextContext(3);\n      return i0.ÉµÉµresetView(ctx_r1.calcular(a_r6));\n    });\n    i0.ÉµÉµelementEnd()();\n  }\n  if (rf & 2) {\n    const col_r5 = ctx.$implicit;\n    const a_r6 = i0.ÉµÉµnextContext().$implicit;\n    i0.ÉµÉµadvance();\n    i0.ÉµÉµtwoWayProperty(\"ngModel\", a_r6.notas[col_r5]);\n  }\n}\nfunction DocenteCalificacionesPage_ng_container_5_table_3_tr_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ÉµÉµelementStart(0, \"tr\")(1, \"td\");\n    i0.ÉµÉµtext(2);\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµtemplate(3, DocenteCalificacionesPage_ng_container_5_table_3_tr_11_td_3_Template, 2, 1, \"td\", 13);\n    i0.ÉµÉµelementStart(4, \"td\");\n    i0.ÉµÉµtext(5);\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµelementStart(6, \"td\", 14);\n    i0.ÉµÉµtext(7);\n    i0.ÉµÉµelementEnd()();\n  }\n  if (rf & 2) {\n    const a_r6 = ctx.$implicit;\n    const ctx_r1 = i0.ÉµÉµnextContext(3);\n    i0.ÉµÉµadvance(2);\n    i0.ÉµÉµtextInterpolate2(\"\", a_r6.apellidos, \" \", a_r6.nombres);\n    i0.ÉµÉµadvance();\n    i0.ÉµÉµproperty(\"ngForOf\", ctx_r1.columnas);\n    i0.ÉµÉµadvance(2);\n    i0.ÉµÉµtextInterpolate(a_r6.promedio);\n    i0.ÉµÉµadvance();\n    i0.ÉµÉµproperty(\"ngClass\", a_r6.estado === \"Aprueba\" ? \"text-success fw-bold\" : \"text-danger fw-bold\");\n    i0.ÉµÉµadvance();\n    i0.ÉµÉµtextInterpolate1(\" \", a_r6.estado, \" \");\n  }\n}\nfunction DocenteCalificacionesPage_ng_container_5_table_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ÉµÉµelementStart(0, \"table\", 11)(1, \"thead\", 12)(2, \"tr\")(3, \"th\");\n    i0.ÉµÉµtext(4, \"Estudiante\");\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµtemplate(5, DocenteCalificacionesPage_ng_container_5_table_3_th_5_Template, 2, 1, \"th\", 13);\n    i0.ÉµÉµelementStart(6, \"th\");\n    i0.ÉµÉµtext(7, \"Promedio\");\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµelementStart(8, \"th\");\n    i0.ÉµÉµtext(9, \"Estado\");\n    i0.ÉµÉµelementEnd()()();\n    i0.ÉµÉµelementStart(10, \"tbody\");\n    i0.ÉµÉµtemplate(11, DocenteCalificacionesPage_ng_container_5_table_3_tr_11_Template, 8, 6, \"tr\", 13);\n    i0.ÉµÉµelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ÉµÉµnextContext(2);\n    i0.ÉµÉµadvance(5);\n    i0.ÉµÉµproperty(\"ngForOf\", ctx_r1.columnas);\n    i0.ÉµÉµadvance(6);\n    i0.ÉµÉµproperty(\"ngForOf\", ctx_r1.alumnos);\n  }\n}\nfunction DocenteCalificacionesPage_ng_container_5_ng_template_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ÉµÉµelementStart(0, \"div\", 16);\n    i0.ÉµÉµtext(1, \" No hay alumnos registrados para este docente. \");\n    i0.ÉµÉµelementEnd();\n  }\n}\nfunction DocenteCalificacionesPage_ng_container_5_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r1 = i0.ÉµÉµgetCurrentView();\n    i0.ÉµÉµelementContainerStart(0);\n    i0.ÉµÉµelementStart(1, \"button\", 8);\n    i0.ÉµÉµlistener(\"click\", function DocenteCalificacionesPage_ng_container_5_Template_button_click_1_listener() {\n      i0.ÉµÉµrestoreView(_r1);\n      const ctx_r1 = i0.ÉµÉµnextContext();\n      return i0.ÉµÉµresetView(ctx_r1.agregarColumna());\n    });\n    i0.ÉµÉµtext(2, \" + Crear Evaluaci\\u00F3n \");\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµtemplate(3, DocenteCalificacionesPage_ng_container_5_table_3_Template, 12, 2, \"table\", 9)(4, DocenteCalificacionesPage_ng_container_5_ng_template_4_Template, 2, 0, \"ng-template\", null, 0, i0.ÉµÉµtemplateRefExtractor);\n    i0.ÉµÉµelementStart(6, \"button\", 10);\n    i0.ÉµÉµlistener(\"click\", function DocenteCalificacionesPage_ng_container_5_Template_button_click_6_listener() {\n      i0.ÉµÉµrestoreView(_r1);\n      const ctx_r1 = i0.ÉµÉµnextContext();\n      return i0.ÉµÉµresetView(ctx_r1.guardar());\n    });\n    i0.ÉµÉµtext(7, \" Guardar Cambios \");\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµelementContainerEnd();\n  }\n  if (rf & 2) {\n    const sinAlumnos_r7 = i0.ÉµÉµreference(5);\n    const ctx_r1 = i0.ÉµÉµnextContext();\n    i0.ÉµÉµadvance(3);\n    i0.ÉµÉµproperty(\"ngIf\", ctx_r1.alumnos.length)(\"ngIfElse\", sinAlumnos_r7);\n    i0.ÉµÉµadvance(3);\n    i0.ÉµÉµproperty(\"disabled\", !ctx_r1.alumnos.length);\n  }\n}\nexport let DocenteCalificacionesPage = /*#__PURE__*/(() => {\n  var _staticBlock;\n  class DocenteCalificacionesPage {\n    constructor(alumnosSrv, auth) {\n      this.alumnosSrv = alumnosSrv;\n      this.auth = auth;\n      this.columnas = ['Tarea 1', 'Tarea 2']; // columnas por defecto\n      this.alumnos = [];\n      this.cargando = false;\n      this.error = false;\n    }\n    ngOnInit() {\n      const idDocente = this.getDocenteId();\n      this.cargarDatos(idDocente);\n    }\n    /** Igual que en DocenteCrearPage: aquÃ­ mapeas usuario â†’ id_docente real */\n    getDocenteId() {\n      const usuario = this.auth.currentUser;\n      const userName = usuario?.username?.toLowerCase() || '';\n      if (userName === 'mariacabrera') return 1;\n      if (userName === 'carlos molina') return 2; // ajusta segÃºn tus IDs reales\n      if (userName === 'luispacheco') return 3; // idem\n      console.warn('getDocenteId: usuario no mapeado, usando id_docente=1 por defecto');\n      return 1;\n    }\n    cargarDatos(idDocente) {\n      this.cargando = true;\n      this.error = false;\n      this.alumnosSrv.listarPorDocente(idDocente).subscribe({\n        next: lista => {\n          this.alumnos = (lista || []).map(a => ({\n            ...a,\n            notas: {\n              // si en un futuro quieres precargar, aquÃ­ pondrÃ­as a.tarea1, etc.\n              'Tarea 1': null,\n              'Tarea 2': null\n            },\n            promedio: null,\n            estado: ''\n          }));\n          this.cargando = false;\n        },\n        error: err => {\n          console.error('[DocenteCalificaciones] error cargando alumnos', err);\n          this.error = true;\n          this.cargando = false;\n        }\n      });\n    }\n    agregarColumna() {\n      const nombre = prompt('Nombre de la nueva evaluaciÃ³n:');\n      if (!nombre) return;\n      const nom = nombre.trim();\n      if (!nom) return;\n      if (!this.columnas.includes(nom)) {\n        this.columnas.push(nom);\n        this.alumnos.forEach(a => a.notas[nom] = null);\n      }\n    }\n    calcular(a) {\n      const valores = Object.values(a.notas).filter(n => n !== null && n !== undefined && n !== '');\n      if (valores.length === 0) {\n        a.promedio = null;\n        a.estado = '';\n        return;\n      }\n      const suma = valores.reduce((acc, n) => acc + Number(n), 0);\n      const prom = suma / valores.length;\n      a.promedio = Number(prom.toFixed(2));\n      a.estado = prom >= 7 ? 'Aprueba' : 'Reprueba';\n    }\n    guardar() {\n      // De momento solo mostramos en consola.\n      // Cuando tengas endpoint en el backend, aquÃ­ haces el POST/PUT.\n      console.log('Notas a guardar:', this.alumnos);\n      alert('Las notas se han registrado en pantalla. Para guardarlas en BD hay que crear el endpoint en el backend. ðŸ˜Š');\n    }\n    static #_ = _staticBlock = () => (this.Éµfac = function DocenteCalificacionesPage_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || DocenteCalificacionesPage)(i0.ÉµÉµdirectiveInject(i1.AlumnosService), i0.ÉµÉµdirectiveInject(i2.AuthService));\n    }, this.Éµcmp = /*@__PURE__*/i0.ÉµÉµdefineComponent({\n      type: DocenteCalificacionesPage,\n      selectors: [[\"app-docente-calificaciones\"]],\n      decls: 6,\n      vars: 3,\n      consts: [[\"sinAlumnos\", \"\"], [1, \"container\", \"mt-4\"], [1, \"mb-3\"], [\"class\", \"alert alert-info\", 4, \"ngIf\"], [\"class\", \"alert alert-danger\", 4, \"ngIf\"], [4, \"ngIf\"], [1, \"alert\", \"alert-info\"], [1, \"alert\", \"alert-danger\"], [1, \"btn\", \"btn-primary\", \"mb-3\", 3, \"click\"], [\"class\", \"table table-bordered table-striped text-center\", 4, \"ngIf\", \"ngIfElse\"], [1, \"btn\", \"btn-success\", 3, \"click\", \"disabled\"], [1, \"table\", \"table-bordered\", \"table-striped\", \"text-center\"], [1, \"table-primary\"], [4, \"ngFor\", \"ngForOf\"], [3, \"ngClass\"], [\"type\", \"number\", \"min\", \"0\", \"max\", \"10\", \"step\", \"0.1\", 1, \"form-control\", 3, \"ngModelChange\", \"ngModel\"], [1, \"alert\", \"alert-warning\"]],\n      template: function DocenteCalificacionesPage_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ÉµÉµelementStart(0, \"div\", 1)(1, \"h2\", 2);\n          i0.ÉµÉµtext(2, \"Registro de Calificaciones\");\n          i0.ÉµÉµelementEnd();\n          i0.ÉµÉµtemplate(3, DocenteCalificacionesPage_div_3_Template, 2, 0, \"div\", 3)(4, DocenteCalificacionesPage_div_4_Template, 2, 0, \"div\", 4)(5, DocenteCalificacionesPage_ng_container_5_Template, 8, 3, \"ng-container\", 5);\n          i0.ÉµÉµelementEnd();\n        }\n        if (rf & 2) {\n          i0.ÉµÉµadvance(3);\n          i0.ÉµÉµproperty(\"ngIf\", ctx.cargando);\n          i0.ÉµÉµadvance();\n          i0.ÉµÉµproperty(\"ngIf\", ctx.error);\n          i0.ÉµÉµadvance();\n          i0.ÉµÉµproperty(\"ngIf\", !ctx.cargando && !ctx.error);\n        }\n      },\n      dependencies: [CommonModule, i3.NgClass, i3.NgForOf, i3.NgIf, FormsModule, i4.DefaultValueAccessor, i4.NumberValueAccessor, i4.NgControlStatus, i4.MinValidator, i4.MaxValidator, i4.NgModel],\n      encapsulation: 2\n    }));\n  }\n  _staticBlock();\n  return DocenteCalificacionesPage;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}